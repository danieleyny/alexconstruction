(self.webpackJsonp=self.webpackJsonp||[]).push([["AppBridgeSessionToken"],{"./app/components/AppBridgeHost/SessionToken/graphql/GenerateSessionToken.graphql":function(e,n,t){"use strict";n.a=JSON.parse('{"kind":"Document","definitions":[{"kind":"OperationDefinition","operation":"mutation","name":{"kind":"Name","value":"GenerateSessionToken"},"variableDefinitions":[{"kind":"VariableDefinition","variable":{"kind":"Variable","name":{"kind":"Name","value":"appId"}},"type":{"kind":"NonNullType","type":{"kind":"NamedType","name":{"kind":"Name","value":"ID"}}},"directives":[]}],"directives":[],"selectionSet":{"kind":"SelectionSet","selections":[{"kind":"Field","name":{"kind":"Name","value":"adminGenerateSession"},"arguments":[{"kind":"Argument","name":{"kind":"Name","value":"appId"},"value":{"kind":"Variable","name":{"kind":"Name","value":"appId"}}}],"directives":[],"selectionSet":{"kind":"SelectionSet","selections":[{"kind":"Field","name":{"kind":"Name","value":"session"},"arguments":[],"directives":[]},{"kind":"Field","name":{"kind":"Name","value":"__typename"},"arguments":[],"directives":[]}]}}]}}],"loc":{"start":0,"end":97,"source":{"body":"mutation GenerateSessionToken($appId:ID!){adminGenerateSession(appId:$appId){session __typename}}","name":"GraphQL request","locationOffset":{"line":1,"column":1}}},"id":"67de24003984a931b9e27ec331b5c38c24daa5c509116c6801bad640dd428470"}')},"./app/components/AppBridgeHost/SessionToken/index.ts":function(e,n,t){"use strict";t.r(n),t.d(n,"default",(function(){return f})),t.d(n,"generateSessionTokenMutation",(function(){return c.a})),t.d(n,"currentTimeInSeconds",(function(){return l.a})),t.d(n,"isAlmostExpired",(function(){return l.b}));var s=t("./node_modules/react/index.js"),i=t("./node_modules/@shopify/app-bridge/index.js"),o=t("./node_modules/@shopify/react-compose/build/esnext/index.esnext"),a=t("./node_modules/@shopify/app-bridge/actions/index.js"),r=t("./node_modules/@shopify/app-bridge-host/features/sessionToken.js"),d=t.n(r),u=t("./node_modules/@shopify/app-bridge-host/index.js"),p=t("./node_modules/@shopify/react-graphql/build/esnext/hooks/mutation.esnext"),c=t("./app/components/AppBridgeHost/SessionToken/graphql/GenerateSessionToken.graphql"),l=t("./app/components/AppBridgeHost/SessionToken/utilities/jwtHelper.ts");var f=Object(o.a)(d.a)((function({actions:e}){const n=Object(s.useContext)(u.HostContext),t=function(e,n=!0){const[t,i]=Object(s.useState)(),[o,a]=Object(s.useState)(),r=Object(p.a)(c.a),d=Object(s.useRef)(),u=Object(s.useCallback)((async()=>{if(d.current)return d.current;const n=(async()=>{try{var n,t;return(null===(n=(await r({variables:{appId:e}})).data)||void 0===n||null===(t=n.adminGenerateSession)||void 0===t?void 0:t.session)||void 0}catch{return}})();d.current=n;const t=await n;return t&&(i(t),a(Object(l.a)())),d.current=void 0,t}),[e,r]);return Object(s.useEffect)((()=>{!t&&n&&u()}),[n]),Object(s.useCallback)((async()=>Object(l.b)(t,o,8)?u():t),[t,o,u])}(null==n?void 0:n.config.appId);return Object(s.useEffect)((()=>{if(!n)return;const{app:s}=n;return s.subscribe((async({type:n,payload:s})=>{if(n===i.MessageType.Dispatch&&(null==s?void 0:s.type)===a.SessionToken.Action.REQUEST){const n=await t();e.respond({sessionToken:n})}}))}),[e,t,n]),null}))},"./app/components/AppBridgeHost/SessionToken/utilities/jwtHelper.ts":function(e,n,t){"use strict";function s(){return Math.floor(Date.now()/1e3)}t.d(n,"a",(function(){return s})),t.d(n,"b",(function(){return i}));function i(e,n,t=0){if(!e||!n)return!0;const i=(o=e,JSON.parse(atob(o.split(".")[1])));var o;const a=i.exp-i.nbf;return s()-n>a-t}},"./node_modules/@shopify/app-bridge-host/components/utilities/withStatelessFeature.js":function(e,n,t){"use strict";var s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0});var i=s(t("./node_modules/@shopify/app-bridge-host/withFeature.js"));n.default=function(e,n){return i.default({actions:n||{},key:e,initialState:{},reducer:function(e){return e||{}}})}},"./node_modules/@shopify/app-bridge-host/features/sessionToken.js":function(e,n,t){"use strict";var s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0});var i=t("./node_modules/@shopify/app-bridge/actions/index.js"),o=s(t("./node_modules/@shopify/app-bridge-host/components/utilities/withStatelessFeature.js"));n.default=o.default("sessionToken",{respond:i.SessionToken.respond})}}]);